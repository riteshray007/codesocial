{let e=function(){let e=$("#create-post");$(".deletepost").click((e=>{let t=$(e.target).parent();n($(".deletepost",t))})),$(".liketoggle").click((e=>{e.preventDefault(),togglelikefnc($(e.target))})),e.submit((function(a){a.preventDefault(),$.ajax({type:"post",url:"/posts/create_post",data:e.serialize(),success:function(e){let a=t(e.data.post,e.data.path);$(".allposts").prepend(a),$(".deletepost",a).click((()=>{n(".deletepost",a)})),$(".liketoggle",a).click((e=>{e.preventDefault(),console.log($(e.target).attr("href")),togglelikefnc($(e.target))})),notysucess("Post Published!")},error:function(e){console.log(e.responseText)}}),$("#contentinput").val("")}))},t=function(e,t){let n=new Date(e.updatedAt),a=n.getDate();var o;return a+=(o=a)>3&&o<21?"th":o%10==1?"st":o%10==2?"nd":o%10==3?"rd":"th",$(`\n        \n            <div id="post-${e._id}"  class="postbox vcenter" >\n                <div class=" userinfo " >\n                    <span class=" imgspan " >\n                        <img src="${e.user.avatar?e.user.avatar:t}" class="avatar" >\n                    </span>\n                    <span>\n                        <h4 class="username"  > ${e.user.name} </h4> \n                        <span class="posttime" > ${a+" "+n.toLocaleTimeString([],{month:"long",hour:"2-digit",minute:"2-digit",hour12:!0})} </span>\n                    </span>                    \n                    <span class="dropdown" >\n                            <i class="fa-solid fa-ellipsis-vertical"></i>\n                            <div class="dropdownContents " id='${e._id}' >\n                                <p class="deletepost" data-href ="${e._id}" > Delete post  </p>\n                                <p class="editpost" > Edit post  </p>\n                            </div>\n                    </span>                \n                </div>                \n                \n                <p class="contentbox" > ${e.content}</p>\n\n                <div class="likescomments" >\n                    <a  class="liketoggle" href="/likes/toggle?id=${e._id}&type=Post" >  <i class="fa-regular fa-heart"></i> <span class="likes" >  </span> </a>\n                    <span class="comments" >  <i class="fa-regular fa-comment"></i> comments  </span>\n                </div>\n\n                <div class="commentbox" >\n                    <form action="/posts/create_comment/?id=${e._id}" method="post" >\n                        <textarea required  class="commentarea"  name="content"  spellcheck="false" placeholder="Type here ... " adjust ></textarea>\n                        <button type='submit' class="commentbutton" > Add Comment </button>\n                    </form>                    \n                </div>\n\n            </div>\n        `)};function commentformat(e,t){let n=new Date(e.updatedAt);return $(`\n                    <div class="comment" id="comment-${e._id}" >\n\n                        <span class="imgspan" >\n                        <img src="${e.user.avatar?e.user.avatar:t}" class="comm_avatar" >\n                        </span>\n                        \n                        <span class="name_com" >\n                            <span>\n                            <p class="username" > ${e.user.name} </p>\n                                <p class="commenttime" >${n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}</p>\n                            </span>\n                            <p>${e.content} </p>\n                            <a class="liketoggle"  href="/likes/toggle?id=${e._id}&type=Comment" >\n                    \n                                <i class="fa-regular fa-heart"></i>\n                                <span class="likes" > 0  </span> \n                            </a>\n\n                        </span>\n\n                        <span class="dropdown"  >\n                            <i class="fa-solid fa-ellipsis-vertical"></i>\n                            <div class="dropdownContents " id='${e._id}' >\n                                <p class="deletecomm" > Delete comment </p>\n                                \n                                <p class="editcomm" > Edit comment </p>\n                                \n                            </div>\n                        </span>\n\n                    </div>\n\n        `)}function togglelikefnc(e){let t=e.attr("href");$.ajax({type:"POST",url:t,success:function(t){if(t.data.deleted){$(".fa-heart",e).addClass("fa-regular"),$(".fa-heart",e).removeClass("fa-solid");let t=$(".likes",e).html();$(".likes",e).html(+t-1)}else{$(".fa-heart",e).addClass("fa-solid"),$(".fa-heart",e).removeClass("fa-regular");let t=$(".likes",e).html();$(".likes",e).html(+t+1)}},error:function(e){console.log(e.responseText)}})}let n=function(e){$.ajax({type:"get",url:`/posts/delete-post?id=${$(e).attr("data-href")}`,success:function(e){notyerror("Post Removed !"),$(`#post-${e.data.post_id}`).remove()},error:function(e){console.log(e.responseText)}})};function deletecomment(e){$.ajax({type:"get",url:`/posts/deletecomment?id=${e}`,success:e=>{$(`#comment-${e.data.comm}`).remove(),notyerror("Comment Deleted!")},error:e=>{console.log(e.responseText)}})}function notysucess(e){new Noty({theme:"metroui",text:`${e}`,type:"success",timeout:1500,layout:"topRight",progressBar:!0,closeWith:["click"],animation:{open:function(e){var t=this,n=new mojs.Timeline,a=new mojs.Html({el:t.barDom,x:{500:0,delay:0,duration:500,easing:"elastic.out"},isForce3d:!0,onComplete:function(){e((function(e){e()}))}}),o=new mojs.Shape({parent:t.barDom,width:200,height:t.barDom.getBoundingClientRect().height,radius:0,x:{150:-150},duration:600,isShowStart:!0});t.barDom.style.overflow="visible",o.el.style.overflow="hidden";var s=new mojs.Burst({parent:o.el,count:10,top:t.barDom.getBoundingClientRect().height+75,degree:90,radius:75,angle:{[-90]:40},children:{fill:"#EBD761",delay:"stagger(500, -50)",radius:"rand(8, 25)",direction:-1,isSwirl:!0}}),i=new mojs.Burst({parent:o.el,count:2,degree:0,angle:75,radius:{0:100},top:"90%",children:{fill:"#EBD761",pathScale:[.65,1],radius:"rand(12, 15)",direction:[-1,1],delay:400,isSwirl:!0}});n.add(a,s,i,o),n.play()},close:function(e){new mojs.Html({el:this.barDom,x:{0:500,delay:10,duration:500,easing:"cubic.out"},skewY:{0:10,delay:10,duration:500,easing:"cubic.out"},isForce3d:!0,onComplete:function(){e((function(e){e()}))}}).play()}}}).show()}function notyerror(e){new Noty({theme:"metroui",text:`${e}`,type:"error",timeout:1500,layout:"topRight",animation:{open:function(e){var t=this,n=new mojs.Timeline,a=new mojs.Html({el:t.barDom,x:{500:0,delay:0,duration:500,easing:"elastic.out"},isForce3d:!0,onComplete:function(){e((function(e){e()}))}}),o=new mojs.Shape({parent:t.barDom,width:200,height:t.barDom.getBoundingClientRect().height,radius:0,x:{150:-150},duration:600,isShowStart:!0});t.barDom.style.overflow="visible",o.el.style.overflow="hidden";var s=new mojs.Burst({parent:o.el,count:10,top:t.barDom.getBoundingClientRect().height+75,degree:90,radius:75,angle:{[-90]:40},children:{fill:"#EBD761",delay:"stagger(500, -50)",radius:"rand(8, 25)",direction:-1,isSwirl:!0}}),i=new mojs.Burst({parent:o.el,count:2,degree:0,angle:75,radius:{0:100},top:"90%",children:{fill:"#EBD761",pathScale:[.65,1],radius:"rand(12, 15)",direction:[-1,1],delay:400,isSwirl:!0}});n.add(a,s,i,o),n.play()},close:function(e){new mojs.Html({el:this.barDom,x:{0:500,delay:10,duration:500,easing:"cubic.out"},skewY:{0:10,delay:10,duration:500,easing:"cubic.out"},isForce3d:!0,onComplete:function(){e((function(e){e()}))}}).play()}}}).show()}$(".commentbutton").click((e=>{e.preventDefault();let t=$(e.target).parent();$.ajax({type:"post",url:`${$(t).attr("action")}`,data:$(t).serialize(),success:e=>{let n=commentformat(e.data.comment,e.data.path);$(".deletecomm",n).click((t=>{deletecomment(`${e.data.comment._id}`)})),$(".liketoggle",n).click((e=>{e.preventDefault(),console.log($(e.target).attr("href")),togglelikefnc($(e.target))})),$(`#post-${e.data.comment.post} .commentlist`).prepend(n),$(t).children(".commentarea").val(""),notysucess("Comment Posted!")},error:e=>{console.log(e.responseText)}})})),$(".dropdownContents").click((e=>{deletecomment($(e.target).parent().attr("id"))})),e()}